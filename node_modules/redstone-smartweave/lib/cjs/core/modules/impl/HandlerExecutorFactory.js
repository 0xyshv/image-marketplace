"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.HandlerExecutorFactory = void 0;
const _smartweave_1 = require("../../..");
const ContractHandlerApi_1 = require("./ContractHandlerApi");
/**
 * A factory that produces handlers that are compatible with the "current" style of
 * writing SW contracts (ie. using "handle" function).
 */
class HandlerExecutorFactory {
    constructor(arweave) {
        this.arweave = arweave;
        this.logger = _smartweave_1.LoggerFactory.INST.create('HandlerExecutorFactory');
    }
    async create(contractDefinition) {
        const normalizedSource = (0, _smartweave_1.normalizeContractSource)(contractDefinition.src);
        const swGlobal = new _smartweave_1.SmartWeaveGlobal(this.arweave, {
            id: contractDefinition.txId,
            owner: contractDefinition.owner
        });
        const contractFunction = new Function(normalizedSource);
        return new ContractHandlerApi_1.ContractHandlerApi(swGlobal, contractFunction, contractDefinition);
    }
}
exports.HandlerExecutorFactory = HandlerExecutorFactory;
//# sourceMappingURL=HandlerExecutorFactory.js.map